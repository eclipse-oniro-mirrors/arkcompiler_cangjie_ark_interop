# ohos.crypto (Cryptographic Algorithm Library Framework)

Provides unified cryptographic algorithm library interfaces for encryption and decryption operations, shielding underlying hardware and algorithm libraries.

## Import Module

```cangjie
import kit.CryptoArchitectureKit.*
```

## Usage Instructions

API example code usage instructions:

- If the first line of example code contains a "// index.cj" comment, it indicates the example can be compiled and run in the "index.cj" file of the Cangjie template project.
- If the example requires obtaining the [Context](../AbilityKit/cj-apis-ability.md#class-context) application context, configuration is needed in the "main_ability.cj" file of the Cangjie template project.

For details about the example project and configuration template mentioned above, refer to [Cangjie Example Code Description](../../cj-development-intro.md#Cangjie-Example-Code-Description).

## func createCipher(String)

```cangjie
public func createCipher(transformation: String): Cipher
```

**Description:** Obtains a corresponding [Cipher](#class-cipher) instance by specifying the algorithm name.

Supported specifications can be found in [Symmetric Key Encryption/Decryption Algorithm Specifications](../../../../Dev_Guide/source_en/security/CryptoArchitectureKit/cj-crypto-sym-encrypt-decrypt-spec.md) and [Asymmetric Key Encryption/Decryption Algorithm Specifications](../../../../Dev_Guide/source_en/security/CryptoArchitectureKit/cj-crypto-asym-encrypt-decrypt-spec.md).

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Initial Version:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
| :--- | :--- | :--- | :--- | :--- |
| transformation | String | Yes | - | Combination of algorithm name (including key length), encryption mode, and padding method for generating the Cipher. |

**Return Value:**

| Type | Description |
| :---- | :---- |
| [Cipher](#class-cipher) | Returns the encryption/decryption generator object. |

**Exceptions:**

- BusinessException: For detailed error code descriptions, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  | :--- | :--- |
  | 401 | invalid parameters. |
  | 801 | this operation is not supported. |
  | 17620001 | memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let cipherAlgName = "3DES192|ECB|PKCS7"
let cipher = createCipher(cipherAlgName)
```

## func createMac(String)

```cangjie
public func createMac(algName: String): Mac
```

**Description:** Generates a Mac instance for message authentication code calculation and operations.

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Initial Version:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
| :--- | :--- | :--- | :--- | :--- |
| algName | String | Yes | - | Specifies the digest algorithm. |

**Return Value:**

| Type | Description |
| :---- | :---- |
| [Mac](#class-mac) | Returns the Mac object generated by the specified input algorithm. |

**Exceptions:**

- BusinessException: For detailed error code descriptions, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  | :--- | :--- |
  | 401 | invalid parameters. |
  | 17620001 | memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj
import kit.CryptoArchitectureKit.*

var mac = createMac("SHA256")
```

## func createMd(String)

```cangjie
public func createMd(algName: String): Md
```

**Description:** Generates an Md instance for message digest calculation and operations.

**System Capability:** SystemCapability.Security.CryptoFramework.MessageDigest

**Initial Version:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
| :--- | :--- | :--- | :--- | :--- |
| algName | String | Yes | - | Specifies the digest algorithm. |

**Return Value:**

| Type | Description |
| :---- | :---- |
| [Md](#class-md) | Returns the [Md](#class-md) object generated by the specified input algorithm. |

**Exceptions:**

- BusinessException: For detailed error code descriptions, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  | :--- | :--- |
  | 401 | invalid parameters. |
  | 17620001 | memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj
import kit.CryptoArchitectureKit.*

let md = createMd("SHA256")
```

## func createRandom()

```cangjie
public func createRandom(): Random
```

**Description:** Generates a Random instance for random number calculation and seed setting.

**System Capability:** SystemCapability.Security.CryptoFramework.Rand

**Initial Version:** 21

**Return Value:**

| Type | Description |
| :---- | :---- |
| [Random](#class-random) | Returns the [Random](#class-random) object generated by the specified input algorithm. |

**Exceptions:**

- BusinessException: For detailed error code descriptions, refer to [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  | :--- | :--- |
  | 17620001 | memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj
import kit.CryptoArchitectureKit.*

let rand = createRandom()
```

## func createSign(String)

```cangjie
public func createSign(algName: String): Sign
```

**Description:** Generates a Sign instance.

Supported specifications can be found in [Signature/Verification Specifications](../../../../Dev_Guide/source_en/security/CryptoArchitectureKit/cj-crypto-sign-sig-verify-overview.md).

**System Capability:** SystemCapability.Security.CryptoFramework.Signature

**Initial Version:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
| :--- | :--- | :--- | :--- | :--- |
| algName | String | Yes | - | Specifies the signature algorithm: RSA, ECC, DSA, or SM2. When using RSA PKCS1 mode, a digest must be set. When using RSA PSS mode, both digest and mask digest must be set. |

**Return Value:**

| Type | Description |
| :---- | :---- |
| [Sign](#class-sign) | Returns the Sign object generated by the specified input algorithm. |

**Exceptions:**

- BusinessException: For detailed error code descriptions, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  | :--- | :--- |
  | 401 | invalid parameters. |
  | 801 | this operation is not supported. |
  | 17620001 | memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj
import kit.CryptoArchitectureKit.*

var sign = createSign("ECC224|SHA256")
```

## func createSymKeyGenerator(String)

```cangjie
public func createSymKeyGenerator(algName: String): SymKeyGenerator
```

**Description:** Obtains a symmetric key generator instance by specifying the algorithm name string.

Supported specifications can be found in [Symmetric Key Generation and Conversion Specifications](../../../../Dev_Guide/source_en/security/CryptoArchitectureKit/cj-crypto-sym-key-generation-conversion-spec.md).

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Initial Version:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
| :--- | :--- | :--- | :--- | :--- |
| algName | String | Yes | - | Algorithm name of the symmetric key generator to be generated. For specific values, refer to the "String Parameters" section in [Symmetric Key Generation and Conversion Specifications](../../../../Dev_Guide/source_en/security/CryptoArchitectureKit/cj-crypto-sym-key-generation-conversion-spec.md). |

**Return Value:**

| Type | Description |
| :---- | :---- |
| [SymKeyGenerator](#class-symkeygenerator) | Returns the symmetric key generator object. |

**Exceptions:**

- BusinessException: For detailed error code descriptions, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md).

  | Error Code ID | Error Message |
  | :-------- | :---------------------- |
  | 801 | this operation is not supported. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let symKeyGenerator = createSymKeyGenerator("3DES192")
```

## interface Key

```cangjie
public interface Key {
    prop format: String
    prop algName: String
    func getEncoded(): DataBlob
}
```

**Description:** Key (interface). Its subclass objects need to be generated in advance when running cryptographic algorithms (such as encryption/decryption) and passed into the [init()](#func-initcryptomode-key-paramsspec) method of the [Cipher](#class-cipher) instance.

Keys can be generated through key generators.**System Capability:** SystemCapability.Security.CryptoFramework.Key  

**Initial Version:** 21  

### prop algName  

```cangjie  
prop algName: String  
```  

**Description:** The algorithm name (including length) corresponding to the key.  

**Type:** String  

**Access:** Read-only  

**System Capability:** SystemCapability.Security.CryptoFramework.Key  

**Initial Version:** 21  

### prop format  

```cangjie  
prop format: String  
```  

**Description:** The format of the key.  

**Type:** String  

**Access:** Read-only  

**System Capability:** SystemCapability.Security.CryptoFramework.Key  

**Initial Version:** 21  

### func getEncoded()  

```cangjie  
func getEncoded(): DataBlob  
```  

**Description:** Synchronous method to obtain the byte stream of key data. The key can be a symmetric key, public key, or private key.  
- Public key format complies with ASN.1 syntax, X.509 specification, and DER encoding.  
- Private key format complies with ASN.1 syntax, PKCS#8 specification, and DER encoding.  

> **Note:**  
>  
> When generating a private key using key parameters in RSA algorithm, the private key object does not support `getEncoded`.  

**System Capability:** SystemCapability.Security.CryptoFramework.Key  

**Initial Version:** 21  

**Return Value:**  

| Type | Description |  
|:----|:----|  
| [DataBlob](#struct-datablob) | Used to view the specific content of the key. |  

**Exceptions:**  

- BusinessException: For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).  

  | Error Code ID | Error Message |  
  |:---|:---|  
  | 801 | This operation is not supported. |  
  | 17620001 | Memory error. |  
  | 17630001 | Crypto operation error. |  

**Example:**  

<!-- compile -->  

```cangjie  
// index.cj  

import kit.CryptoArchitectureKit.*  

let generator = createSymKeyGenerator("3DES192") // The key is generated by a key generator. The generation process is omitted here.  
let key = generator.generateSymKey()  
let encodedKey = key.getEncoded()  
```  

## interface ParamsSpec  

```cangjie  
public interface ParamsSpec {  
    mut prop algName: String  
    mut prop iv: DataBlob  
}  
```  

**Description:** Encryption/decryption parameters. During symmetric encryption/decryption, a subclass object needs to be constructed and passed into the [init()](#func-initcryptomode-key-paramsspec) method.  

Applicable to symmetric encryption/decryption modes that require parameters like `iv` (for modes without `iv` such as ECB, no construction is needed; pass `None` in [init()](#func-initcryptomode-key-paramsspec)).  

> **Note:**  
>  
> Since the `params` parameter in [init()](#func-initcryptomode-key-paramsspec) is of type `ParamsSpec` (parent class), but the actual requirement is to pass a specific subclass object (e.g., `IvParamsSpec`), the `algName` parameter of the parent class `ParamsSpec` should be set when constructing the subclass object. This allows the algorithm library to know which subclass object is being passed during `init()`.  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

### prop algName  

```cangjie  
mut prop algName: String  
```  

**Description:** Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values:  
- "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes.  
- "GcmParamsSpec": Applicable to GCM mode.  
- "CcmParamsSpec": Applicable to CCM mode.  

**Type:** String  

**Access:** Read-write  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

### prop iv  

```cangjie  
mut prop iv: DataBlob  
```  

**Description:** Specifies the `iv` parameter for encryption/decryption. Common values:  
- AES CBC\|CTR\|OFB\|CFB modes: `iv` length is 16 bytes.  
- 3DES CBC\|OFB\|CFB modes: `iv` length is 8 bytes.  
- SM4 CBC\|CTR\|OFB\|CFB modes: `iv` length is 16 bytes.  

**Type:** [DataBlob](#struct-datablob)  

**Access:** Read-write  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

## class Cipher  

```cangjie  
public class Cipher {}  
```  

**Description:** Provides encryption/decryption algorithm operations. By sequentially calling [init()](#func-initcryptomode-key-paramsspec), [update()](#func-updatedatablob), and [doFinal()](#func-dofinaldatablob) methods, symmetric encryption/decryption or asymmetric encryption/decryption can be achieved.  

The complete encryption/decryption process differs slightly between symmetric and asymmetric encryption:  

- Symmetric encryption/decryption: `init` is mandatory, `update` is optional (and allows multiple `update` calls for large data), and `doFinal` is mandatory. After `doFinal`, a new round of encryption/decryption can be started by calling `init` again.  
- RSA and SM2 asymmetric encryption/decryption: `init` is mandatory, `update` is not supported, and `doFinal` is mandatory (allowing multiple consecutive `doFinal` calls for large data). RSA does not support repeated `init`; to switch encryption/decryption modes or padding schemes, a new `Cipher` object must be created.  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

### prop algName  

```cangjie  
public prop algName: String  
```  

**Description:** The algorithm name specified by the encryption/decryption generator.  

**Type:** String  

**Access:** Read-only  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

### func `init`(CryptoMode, Key, ?ParamsSpec)  

```cangjie  
public func `init`(opMode: CryptoMode, key: Key, params: ?ParamsSpec): Unit  
```  

**Description:** Initializes the [Cipher](#class-cipher) object for encryption/decryption and obtains the result via a registered callback function.  

This function can only be used after creating a [Cipher](#class-cipher) instance with [createCipher](#func-createcipherstring).  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

**Parameters:**  

| Parameter | Type | Required | Default | Description |  
|:---|:---|:---|:---|:---|  
| opMode | [CryptoMode](#enum-cryptomode) | Yes | - | Encryption or decryption mode. |  
| key | [Key](#interface-key) | Yes | - | Specifies the key for encryption/decryption. |  
| params | ?[ParamsSpec](#interface-paramsspec) | Yes | - | Specifies encryption/decryption parameters. For algorithm modes like ECB that do not require parameters, `None` can be passed. |  

**Exceptions:**  

- BusinessException: For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).  

  | Error Code ID | Error Message |  
  |:---|:---|  
  | 401 | Invalid parameters. |  
  | 17620001 | Memory error. |  
  | 17620002 | Runtime error. |  
  | 17630001 | Crypto operation error. |  

**Example:**  

<!-- compile -->  

```cangjie  
// index.cj  

import kit.CryptoArchitectureKit.*  

let cipherAlgName = "RSA|PKCS1_OAEP|SHA256|MGF1_SHA1"  
let cipher = createCipher(cipherAlgName)  
let syg = createSymKeyGenerator("AES128")  
let sk = syg.generateSymKey()  
cipher.`init`(CryptoMode.ENCRYPT_MODE, sk, None)  
```  

### func doFinal(?DataBlob)  

```cangjie  
public func doFinal(data: ?DataBlob): DataBlob  
```  

**Description:**  
(1) In symmetric encryption/decryption, `doFinal` encrypts/decrypts the remaining data (generated by block mode) and the current input data, finally completing the encryption/decryption operation and obtaining the result.  

If the data volume is small, data can be passed in one go in `doFinal` without using `update`. If `update` has already been used in the current encryption/decryption process, `None` can be passed for the `data` parameter in `doFinal`.  

Depending on the symmetric encryption/decryption mode, the output of `doFinal` differs as follows:  

- For GCM and CCM symmetric encryption: In one encryption process, concatenating the results of each `update` and `doFinal` yields "ciphertext + authTag," where the last 16 bytes (GCM) or 12 bytes (CCM) are `authTag`, and the rest is ciphertext. (If `None` is passed for `data` in `doFinal`, the result is `authTag`.) `authTag` must be filled into [GcmParamsSpec](#struct-gcmparamsspec) or [CcmParamsSpec](#struct-ccmparamsspec) during decryption; the ciphertext is passed as the `data` parameter during decryption.  
- For other symmetric encryption/decryption modes and GCM/CCM decryption: In one encryption/decryption process, concatenating the results of each `update` and `doFinal` yields the complete plaintext/ciphertext.  

(2) In RSA and SM2 asymmetric encryption/decryption, `doFinal` encrypts/decrypts the current input data and obtains the result. If the data volume is large, `doFinal` can be called multiple times, and the results can be concatenated to form the complete plaintext/ciphertext.  

> **Note:**  
>  
> - In symmetric encryption/decryption, calling `doFinal` marks the completion of one encryption/decryption process, meaning the state of the [Cipher](#class-cipher) instance is cleared. Therefore, when starting a new encryption/decryption process, `init()` must be called again with the full parameter list for initialization (e.g., even if the same `Cipher` instance and symmetric key are used for encryption followed by decryption, the `params` parameter in `init` during decryption must still be specified and cannot be omitted as `None`).  
> - If decryption fails, check whether the encryption/decryption data matches the parameters in `init`, including whether the `authTag` obtained during GCM encryption is filled into `GcmParamsSpec` during decryption.  
> - The result of `doFinal` may be empty. Before accessing the specific data of the result using the `.data` field, ensure the result is not empty to avoid exceptions.  

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher  

**Initial Version:** 21  

**Parameters:**  

| Parameter | Type | Required | Default | Description |  
|:---|:---|:---|:---|:---|  
| data | ?[DataBlob](#struct-datablob) | Yes | - | Data to be encrypted/decrypted. The `data` parameter can be `None`, but `{data: Array<UInt8>() }` is not allowed. |  

**Return Value:**  

| Type | Description |  
|:----|:----|  
| [DataBlob](#struct-datablob) | Returns the encryption/decryption result of the remaining data as `DataBlob`. |  

**Exceptions:**  

- BusinessException: For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).  

  | Error Code ID | Error Message |  
  |:---|:---|  
  | 401 | Invalid parameters. |  
  | 17620001 | Memory error. |  
  | 17620002 | Runtime error. |  
  | 17630001 | Crypto operation error. |  

**Example:**  

<!-- compile -->  

```cangjie  
// index.cj  

import kit.CryptoArchitectureKit.*  

let cipherAlgName = "RSA|PKCS1_OAEP|SHA256|MGF1_SHA1"  
let cipher = createCipher(cipherAlgName)  
let syg = createSymKeyGenerator("AES128")  
let sk = syg.generateSymKey()  
cipher.`init`(CryptoMode.ENCRYPT_MODE, sk, None)  
cipher.doFinal(None)  
```  

### func update(DataBlob)  

```cangjie  
public func update(data: DataBlob): DataBlob  
```  

**Description:** Incrementally updates the encryption/decryption operation and obtains the result.  

This function can only be used after initializing the [Cipher](#class-cipher) instance with [init()](#func-initcryptomode-key-paramsspec).  

> **Note:**  
>  
> - During symmetric encryption/decryption, if developers are not familiar with various block modes, it is recommended to check whether the results of each `update` and `doFinal` are empty arrays. If not, concatenate the data to form the complete ciphertext/plaintext. This is because the chosen block mode and other specifications may affect the results of `update` and `doFinal`.  
> (For example, in ECB and CBC modes, regardless of whether the data passed to `update` is an integer multiple of the block length, encryption/decryption is performed in blocks, and the newly generated result for this `update` is output.  
>   Conceptually, `update` outputs as soon as a new block is filled. If no block is filled, the output is `None`, and the remaining data is retained for concatenation with the next `update`/`doFinal` input to continue filling blocks.)> During the final `doFinal` operation, any remaining data that has not been encrypted/decrypted will be padded according to the padding mode set during [createCipher](#func-createcipherstring), ensuring it reaches an integer multiple of the block length before outputting the remaining encryption/decryption results.
> For modes that can transform block ciphers into stream implementations, there may also be cases where the ciphertext length matches the plaintext length, etc.)
> - Depending on the data volume, you may choose not to call `update` (i.e., directly call `doFinal` after `init`) or call `update` multiple times.
> The algorithm library currently does not impose size limits on the data volume for `update` (single or cumulative). For large-scale symmetric encryption/decryption, it is recommended to pass data via multiple `update` calls.
> - Asymmetric encryption/decryption like RSA and SM2 does not support the `update` operation.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Parameter | Type | Required | Default | Description |
|:---|:---|:---|:---|:---|
| data | [DataBlob](#struct-datablob) | Yes | - | Data to be encrypted or decrypted. `data` cannot be passed as `{data: Array\<UInt8>() }`. |

**Return Value:**

| Type | Description |
|:----|:----|
| [DataBlob](#struct-datablob) | Returns the updated encryption/decryption result as a `DataBlob`. |

**Exceptions:**

- **BusinessException:** For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

| Error Code ID | Error Message |
|:----|:---|
| 401 | Invalid parameters. |
| 17620001 | Memory error. |
| 17620002 | Runtime error. |
| 17630001 | Crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let cipherAlgName = "RSA|PKCS1_OAEP|SHA256|MGF1_SHA1"
let cipher = createCipher(cipherAlgName)
let syg = createSymKeyGenerator("AES128")
let sk = syg.generateSymKey()
cipher.`init`(CryptoMode.ENCRYPT_MODE, sk, None)
let plainText: DataBlob = DataBlob("this is test".toArray())
cipher.update(plainText)
```

## class Mac

```cangjie
public class Mac {}
```

**Description:** The `Mac` class enables Message Authentication Code (MAC) encryption calculations. Before use, construct a `Mac` instance via [createMac](#func-createmacstring).

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Since:** 21

### prop algName

```cangjie
public prop algName: String
```

**Description:** Represents the specified digest algorithm name.

**Type:** String

**Access:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Since:** 21

### func `init`(SymKey)

```cangjie
public func `init`(key: SymKey): Unit
```

**Description:** Initializes the [Mac](#class-mac) calculation using a symmetric key and retrieves the result via a registered callback function.

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Since:** 21

**Parameters:**

| Parameter | Type | Required | Default | Description |
|:---|:---|:---|:---|:---|
| key | [SymKey](#class-symkey) | Yes | - | Shared symmetric key. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let skg = createSymKeyGenerator("AES128")
let sk = skg.generateSymKey()
let mac = createMac("SHA256")
mac.`init`(sk)
```

### func doFinal()

```cangjie
public func doFinal(): DataBlob
```

**Description:** Returns the MAC calculation result.

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| [DataBlob](#struct-datablob) | Returns the calculation result as a `DataBlob`. |

**Exceptions:**

- **BusinessException:** For detailed error codes, refer to [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

| Error Code ID | Error Message |
|:---|:---|
| 17620001 | Memory error. |
| 17630001 | Crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let mac = createMac("SHA256")

let skg = createSymKeyGenerator("AES128")
let sk = skg.generateSymKey()
mac.`init`(sk)
let blob = DataBlob("this is test!".toArray())
mac.update(blob)
mac.doFinal()
```

### func getMacLength()

```cangjie
public func getMacLength(): UInt32
```

**Description:** Retrieves the length (in bytes) of the MAC message authentication code.

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| UInt32 | Returns the byte length of the MAC calculation result. |

**Exceptions:**

- **BusinessException:** For detailed error codes, refer to [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

| Error Code ID | Error Message |
|:---|:---|
| 17630001 | Crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let mac = createMac("SHA256")
let skg = createSymKeyGenerator("AES128")
let sk = skg.generateSymKey()
mac.`init`(sk)
let blob = DataBlob("this is test!".toArray())
mac.update(blob)
mac.doFinal()
var macLen = mac.getMacLength()
```

### func update(DataBlob)

```cangjie
public func update(input: DataBlob): Unit
```

**Description:** Updates the MAC calculation with the input message.

**System Capability:** SystemCapability.Security.CryptoFramework.Mac

**Since:** 21

**Parameters:**

| Parameter | Type | Required | Default | Description |
|:---|:---|:---|:---|:---|
| input | [DataBlob](#struct-datablob) | Yes | - | Input message. |

**Exceptions:**

- **BusinessException:** For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

| Error Code ID | Error Message |
|:---|:---|
| 401 | Invalid parameters. |
| 17630001 | Crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let mac = createMac("SHA256")
let skg = createSymKeyGenerator("AES128")
let sk = skg.generateSymKey()
mac.`init`(sk)
let blob = DataBlob("this is test!".toArray())
mac.update(blob)
```

## class Md

```cangjie
public class Md {}
```

**Description:** The `Md` class enables Message Digest (MD) calculations. Before use, construct an `Md` instance via [createMd](#func-createmdstring).

**System Capability:** SystemCapability.Security.CryptoFramework.MessageDigest

**Since:** 21

### prop algName

```cangjie
public prop algName: String
```

**Description:** Represents the specified digest algorithm name.

**Type:** String

**Access:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.MessageDigest

**Since:** 21

### func digest()

```cangjie
public func digest(): DataBlob
```

**Description:** Returns the MD calculation result.

**System Capability:** SystemCapability.Security.CryptoFramework.MessageDigest

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| [DataBlob](#struct-datablob) | Returns the calculation result as a `DataBlob`. |

**Exceptions:**

- **BusinessException:** For detailed error codes, refer to [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

| Error Code ID | Error Message |
|:---|:---|
| 17620001 | Memory error. |  |17630001|crypto operation error.|

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let md = createMd("SHA256")
let blob: DataBlob = DataBlob("test".toArray())
md.update(blob)
let res = md.digest()
```

### func getMdLength()

```cangjie
public func getMdLength(): UInt32
```

**Function:** Gets the byte length of the MD message digest.

**System Capability:** SystemCapability.Security.CryptoFramework.MessageDigest

**Since:** 21

**Return Value:**

| Type   | Description |
|:------|:-----------|
| UInt32 | Returns the byte length of the MD computation result. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [crypto framework error codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:-------------|:-------------|
  | 17630001     | crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let md = createMd("SHA256")
let mdLen = md.getMdLength()
```

### func update(DataBlob)

```cangjie
public func update(input: DataBlob): Unit
```

**Function:** Updates the MD computation with the input message.

**System Capability:** SystemCapability.Security.CryptoFramework.MessageDigest

**Since:** 21

**Parameters:**

| Parameter | Type                     | Mandatory | Default | Description |
|:---------|:------------------------|:---------|:-------|:-----------|
| input    | [DataBlob](#struct-datablob) | Yes      | -      | Input message. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [universal error codes](../../errorcodes/cj-errorcode-universal.md) and [crypto framework error codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:-------------|:-------------|
  | 401          | invalid parameters. |
  | 17630001     | crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let md = createMd("SHA256")
let blob: DataBlob = DataBlob("test".toArray())
md.update(blob)
```

## class Random

```cangjie
public class Random {}
```

**Function:** The Random class, which can be used to perform random number computations. Before calling Random methods, a Random instance must be constructed via [createRandom](#func-createrandom).

**System Capability:** SystemCapability.Security.CryptoFramework.Rand

**Since:** 21

### prop algName

```cangjie
public prop algName: String
```

**Function:** Represents the currently used random number generation algorithm. Currently, only "CTR_DRBG" is supported.

**Type:** String

**Read/Write Permission:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.Rand

**Since:** 21

### func generateRandom(Int32)

```cangjie
public func generateRandom(len: Int32): DataBlob
```

**Function:** Generates a random number of the specified length and returns it.

**System Capability:** SystemCapability.Security.CryptoFramework.Rand

**Since:** 21

**Parameters:**

| Parameter | Type  | Mandatory | Default | Description |
|:---------|:-----|:---------|:-------|:-----------|
| len      | Int32 | Yes      | -      | Length of the random number to generate, in bytes. Range: [1, INT32_MAX]. |

**Return Value:**

| Type                     | Description |
|:------------------------|:-----------|
| [DataBlob](#struct-datablob) | DataBlob object. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [universal error codes](../../errorcodes/cj-errorcode-universal.md) and [crypto framework error codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:-------------|:-------------|
  | 401          | invalid parameters. |
  | 17620001     | memory error. |
  | 17630001     | crypto operation error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let rand = createRandom()
let promiseGenerateRand = rand.generateRandom(12)
```

### func setSeed(DataBlob)

```cangjie
public func setSeed(seed: DataBlob): Unit
```

**Function:** Sets the specified seed.

**System Capability:** SystemCapability.Security.CryptoFramework.Rand

**Since:** 21

**Parameters:**

| Parameter | Type                     | Mandatory | Default | Description |
|:---------|:------------------------|:---------|:-------|:-----------|
| seed     | [DataBlob](#struct-datablob) | Yes      | -      | Seed to set. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [crypto framework error codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:-------------|:-------------|
  | 17620001     | memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let rand = createRandom()
rand.setSeed(DataBlob("test".toArray()))
```

## class Sign

```cangjie
public class Sign {}
```

**Function:** The Sign class. Before using Sign methods, an instance of this class must be created via the [createSign](#func-createsignstring) method. The signing operation is completed by sequentially calling the init, update, and sign methods of this class.

The Sign class does not support repeated initialization. When a new key is needed for signing, a new Sign object must be created and initialized via init.

When using this class, the signing mode is determined during createSign, and the key is set via the init interface.

For short data to be signed, after initialization via init, the sign interface can be called directly (without update) by passing the original data.

For long data to be signed, the update interface can be used to pass segmented original data, and finally the sign interface is called to sign the entire original data.

**System Capability:** SystemCapability.Security.CryptoFramework.Signature

**Since:** 21

### prop algName

```cangjie
public prop algName: String
```

**Function:** Specifies the algorithm name for signing.

**Type:** String

**Read/Write Permission:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.Signature

**Since:** 21

## class SymKey

```cangjie
public class SymKey <: Key {}
```

**Function:** Symmetric key, a subclass of [Key](#interface-key), which must be passed to the [init()](#func-initcryptomode-key-paramsspec) method of a [Cipher](#class-cipher) instance during symmetric encryption/decryption.

Symmetric keys can be generated via the symmetric key generator [SymKeyGenerator](#class-symkeygenerator).

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Since:** 21

**Parent Type:**

- [Key](#interface-key)

### prop algName

```cangjie
public prop algName: String
```

**Function:** The algorithm name (including length) corresponding to the key.

**Type:** String

**Read/Write Permission:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.Key

**Since:** 21

### prop format

```cangjie
public prop format: String
```

**Function:** The format of the key.

**Type:** String

**Read/Write Permission:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.Key

**Since:** 21

### func clearMem()

```cangjie
public func clearMem(): Unit
```

**Function:** Synchronous method to zeroize the key content in the underlying system memory. It is recommended to call this function when the symmetric key instance is no longer needed, to prevent prolonged retention of key data in memory.

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Since:** 21

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let generator = createSymKeyGenerator("3DES192")
let key = generator.generateSymKey()
var encodedKey = key.getEncoded()
AppLog.info("key blob: ${encodedKey.data}") // Display key content.
key.clearMem()
encodedKey = key.getEncoded()
AppLog.info("key blob: ${encodedKey.data}") // Display all 0s.
```

### func getEncoded()

```cangjie
public func getEncoded(): DataBlob
```

**Function:** Synchronous method to obtain the byte stream of key data. The key can be a symmetric key, public key, or private key. The public key format complies with ASN.1 syntax, X.509 specification, and DER encoding format; the private key format complies with ASN.1 syntax, PKCS#8 specification, and DER encoding method.

**System Capability:** SystemCapability.Security.CryptoFramework.Key

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| [DataBlob](#struct-datablob) | Used to view the specific content of the key. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:---|:---|
  | 801 | This operation is not supported. |
  | 17620001 | Memory error. |
  | 17630001 | Crypto operation error. |

## class SymKeyGenerator

```cangjie
public class SymKeyGenerator {}
```

**Function:** Symmetric key generator.

Before using the methods of this class, you need to construct a symKeyGenerator instance using the [createSymKeyGenerator](#func-createsymkeygeneratorstring) method.

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Since:** 21

### prop algName

```cangjie
public prop algName: String
```

**Function:** The algorithm name specified by the symmetric key generator.

**Type:** String

**Read/Write Permission:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Since:** 21

### func convertKey(DataBlob)

```cangjie
public func convertKey(key: DataBlob): SymKey
```

**Function:** Generates a symmetric key based on the specified data.

This function can only be used after creating a symmetric key generator with [createSymKeyGenerator](#func-createsymkeygeneratorstring).

> **Note:**
>
> For symmetric keys of the HMAC algorithm, if a specific hash algorithm has been specified when creating the symmetric key generator (e.g., "HMAC|SHA256"), binary key data consistent with the hash length must be passed in (e.g., 256-bit key data corresponding to SHA256).
> If no specific hash algorithm is specified when creating the symmetric key generator, such as only specifying "HMAC", any binary key data with a length in the range [1,4096] (in bytes) can be passed in.

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Since:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
|:---|:---|:---|:---|:---|
| key | [DataBlob](#struct-datablob) | Yes | - | Specified key material data. |

**Return Value:**

| Type | Description |
|:----|:----|
| [SymKey](#class-symkey) | Returns the symmetric key SymKey. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [Universal Error Codes](../../errorcodes/cj-errorcode-universal.md) and [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:---|:---|
  | 401 | Invalid parameters. |
  | 17620001 | Memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let arr: Array<UInt8> = [0xba, 0x3d, 0xc2, 0x71, 0x21, 0x1e, 0x30, 0x56, 0xad, 0x47, 0xfc, 0x5a,
    0x46, 0x39, 0xee, 0x7c, 0xba, 0x3b, 0xc2, 0x71, 0xab, 0xa0, 0x30, 0x72] // keyLen = 192 (24 bytes)
let symAlgName = "3DES192"
let symKeyGenerator = createSymKeyGenerator(symAlgName)
symKeyGenerator.convertKey(DataBlob(arr))
```

### func generateSymKey()

```cangjie
public func generateSymKey(): SymKey
```

**Function:** Obtains a randomly generated key from this symmetric key generator.

This function can only be used after creating a symmetric key generator with [createSymKeyGenerator](#func-createsymkeygeneratorstring).

Currently, OpenSSL's RAND_priv_bytes() is used as the underlying capability to generate random keys.

**System Capability:** SystemCapability.Security.CryptoFramework.Key.SymKey

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| [SymKey](#class-symkey) | Symmetric key SymKey. |

**Exceptions:**

- BusinessException: For detailed error codes, refer to [Crypto Framework Error Codes](../../errorcodes/cj-errorcode-crypto.md).

  | Error Code ID | Error Message |
  |:---|:---|
  | 17620001 | Memory error. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let symAlgName = "AES128"
let symKeyGenerator = createSymKeyGenerator(symAlgName)
let symKey = symKeyGenerator.generateSymKey()
```

## struct CcmParamsSpec

```cangjie
public struct CcmParamsSpec <: ParamsSpec {
    public init(algName: String, iv: DataBlob, add: DataBlob, authTag: DataBlob)
}
```

**Function:** A subclass of the encryption/decryption parameter [ParamsSpec](#interface-paramsspec), used as a parameter for the [init()](#func-initcryptomode-key-paramsspec) method during symmetric encryption/decryption.

Applicable to CCM mode.

> **Note:**
>
> The algName property (inherited from the parent class [ParamsSpec](#interface-paramsspec)) must be specified before passing it to the [init()](#func-initcryptomode-key-paramsspec) method.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parent Type:**

- [ParamsSpec](#interface-paramsspec)

### prop aad

```cangjie
public mut prop aad: DataBlob
```

**Function:** Specifies the encryption/decryption parameter aad, with a length of 8 bytes.

**Type:** [DataBlob](#struct-datablob)

**Read/Write Permission:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop algName

```cangjie
public mut prop algName: String
```

**Function:** Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values are: <br/> - "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes. <br/> - "GcmParamsSpec": Applicable to GCM mode. <br/> - "CcmParamsSpec": Applicable to CCM mode.

**Type:** String

**Read/Write Permission:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop authTag

```cangjie
public mut prop authTag: DataBlob
```

**Function:** Specifies the encryption/decryption parameter authTag, with a length of 12 bytes. <br/>When encrypting in CCM mode, you need to obtain the [DataBlob](#struct-datablob) output by [doFinal()](#func-dofinaldatablob), extract its last 12 bytes, and use them as the authTag in the [CcmParamsSpec](#struct-ccmparamsspec) parameter for the [init()](#func-initcryptomode-key-paramsspec) method during decryption.

**Type:** [DataBlob](#struct-datablob)

**Read/Write Permission:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop iv

```cangjie
public mut prop iv: DataBlob
```

**Function:** Specifies the encryption/decryption parameter iv, with a length of 7 bytes.

**Type:** [DataBlob](#struct-datablob)

**Read/Write Permission:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### init(String, DataBlob, DataBlob, DataBlob)

```cangjie
public init(algName: String, iv: DataBlob, add: DataBlob, authTag: DataBlob)
```

**Function:** Creates a CcmParamsSpec instance.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Parameter Name | Type | Required | Default Value | Description |
|:---|:---|:---|:---|:---|
| algName | String | Yes | - | Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values are: <br/> - "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes. <br/> - "GcmParamsSpec": Applicable to GCM mode. <br/> - "CcmParamsSpec": Applicable to CCM mode. |
| iv | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter iv, with a length of 7 bytes. |
| add | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter aad, with a length of 8 bytes. |
| authTag | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter authTag, with a length of 12 bytes. When encrypting in CCM mode, you need to obtain the DataBlob output by [doFinal()](#func-dofinaldatablob), extract its last 12 bytes, and use them as the authTag in the [CcmParamsSpec](#struct-ccmparamsspec) parameter for the [init()](#func-initcryptomode-key-paramsspec) method during decryption. |

**Example:**

<!-- compile -->

```cangjie
// index.cj
import kit.CryptoArchitectureKit.*

let ccm = GcmParamsSpec("CcmParamsSpec", DataBlob(Array<UInt8>(7, repeat: 1)), DataBlob(Array<UInt8>(8, repeat: 1)), DataBlob(Array<UInt8>(12, repeat: 1)))
```

## struct DataBlob

```cangjie
public struct DataBlob {
    public DataBlob(
        public let data: Array<UInt8>
    )
}
```

**Function:** Data type for storing arrays.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### let data

```cangjie
public let data: Array<UInt8>
```

**Function:** Data.

**Type:** Array\<UInt8>

**Access:** Read-only

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### DataBlob(Array\<UInt8>)

```cangjie
public DataBlob(
    public let data: Array<UInt8>
)
```

**Function:** Creates a DataBlob instance.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

**Parameters:**

| Name | Type | Required | Default | Description |
|:---|:---|:---|:---|:---|
| data | Array\<UInt8> | Yes | - | Data. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let blob = DataBlob("test".toArray())
```

## struct GcmParamsSpec

```cangjie
public struct GcmParamsSpec <: ParamsSpec {
    public init(algName: String, iv: DataBlob, add: DataBlob, authTag: DataBlob)
}
```

**Function:** A subclass of encryption/decryption parameters [ParamsSpec](#interface-paramsspec), used as a parameter for the [init()](#func-initcryptomode-key-paramsspec) method during symmetric encryption/decryption.

Applicable to GCM mode.

> **Note:**
>
> The algName property (inherited from the parent class [ParamsSpec](#interface-paramsspec)) must be specified before passing it to the [init()](#func-initcryptomode-key-paramsspec) method.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parent Type:**

- [ParamsSpec](#interface-paramsspec)

### prop aad

```cangjie
public mut prop aad: DataBlob
```

**Function:** Specifies the encryption/decryption parameter aad, with a length of 8 bytes.

**Type:** [DataBlob](#struct-datablob)

**Access:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop algName

```cangjie
public mut prop algName: String
```

**Function:** Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values include:<br/> - "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes.<br/> - "GcmParamsSpec": Applicable to GCM mode.<br/> - "CcmParamsSpec": Applicable to CCM mode.

**Type:** String

**Access:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop authTag

```cangjie
public mut prop authTag: DataBlob
```

**Function:** Specifies the encryption/decryption parameter authTag, with a length of 16 bytes.<br/>When encrypting in GCM mode, the [DataBlob](#struct-datablob) output by [doFinal()](#func-dofinaldatablob) should be obtained, and the last 16 bytes should be used as the authTag parameter in the [GcmParamsSpec](#struct-gcmparamsspec) input to the [init()](#func-initcryptomode-key-paramsspec) method during decryption.

**Type:** [DataBlob](#struct-datablob)

**Access:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop iv

```cangjie
public mut prop iv: DataBlob
```

**Function:** Specifies the encryption/decryption parameter iv, with a length of 12 bytes.

**Type:** [DataBlob](#struct-datablob)

**Access:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### init(String, DataBlob, DataBlob, DataBlob)

```cangjie
public init(algName: String, iv: DataBlob, add: DataBlob, authTag: DataBlob)
```

**Function:** Creates a GcmParamsSpec instance.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Name | Type | Required | Default | Description |
|:---|:---|:---|:---|:---|
| algName | String | Yes | - | Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values include:<br/> - "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes.<br/> - "GcmParamsSpec": Applicable to GCM mode.<br/> - "CcmParamsSpec": Applicable to CCM mode. |
| iv | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter iv, with a length of 12 bytes. |
| add | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter aad, with a length of 8 bytes. |
| authTag | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter authTag, with a length of 16 bytes.<br/>When encrypting in GCM mode, the [DataBlob](#struct-datablob) output by [doFinal()](#func-dofinaldatablob) should be obtained, and the last 16 bytes should be used as the authTag parameter in the [GcmParamsSpec](#struct-gcmparamsspec) input to the [init()](#func-initcryptomode-key-paramsspec) method during decryption. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let gcm = GcmParamsSpec("GcmParamsSpec", DataBlob(Array<UInt8>(12, repeat: 1)), DataBlob(Array<UInt8>(8, repeat: 1)), DataBlob(Array<UInt8>(16, repeat: 1)))
```

## struct IvParamsSpec

```cangjie
public struct IvParamsSpec <: ParamsSpec {
    public init(algName: String, iv: DataBlob)
}
```

**Function:** A subclass of encryption/decryption parameters [ParamsSpec](#interface-paramsspec), used as a parameter for the [init()](#func-initcryptomode-key-paramsspec) method during symmetric encryption/decryption.

Applicable to CBC, CTR, OFB, and CFB modes that only use iv as a parameter.

> **Note:**
>
> The algName property (inherited from the parent class [ParamsSpec](#interface-paramsspec)) must be specified before passing it to the [init()](#func-initcryptomode-key-paramsspec) method.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parent Type:**

- [ParamsSpec](#interface-paramsspec)

### prop algName

```cangjie
public mut prop algName: String
```

**Function:** Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values include:<br/> - "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes.<br/> - "GcmParamsSpec": Applicable to GCM mode.<br/> - "CcmParamsSpec": Applicable to CCM mode.

**Type:** String

**Access:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### prop iv

```cangjie
public mut prop iv: DataBlob
```

**Function:** Specifies the encryption/decryption parameter iv. Common values include:<br/>- AES CBC\|CTR\|OFB\|CFB modes: iv length is 16 bytes.<br/>- 3DES CBC\|OFB\|CFB modes: iv length is 8 bytes.<br/>- SM4 CBC\|CTR\|OFB\|CFB modes: iv length is 16 bytes.

**Type:** [DataBlob](#struct-datablob)

**Access:** Read-write

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### init(String, DataBlob)

```cangjie
public init(algName: String, iv: DataBlob)
```

**Function:** Creates an IvParamsSpec instance.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Name | Type | Required | Default | Description |
|:---|:---|:---|:---|:---|
| algName | String | Yes | - | Specifies the algorithm mode for symmetric encryption/decryption parameters. Possible values include:<br/> - "IvParamsSpec": Applicable to CBC\|CTR\|OFB\|CFB modes.<br/> - "GcmParamsSpec": Applicable to GCM mode.<br/> - "CcmParamsSpec": Applicable to CCM mode. |
| iv | [DataBlob](#struct-datablob) | Yes | - | Specifies the encryption/decryption parameter iv. Common values include:<br/>- AES CBC\|CTR\|OFB\|CFB modes: iv length is 16 bytes.<br/>- 3DES CBC\|OFB\|CFB modes: iv length is 8 bytes.<br/>- SM4 CBC\|CTR\|OFB\|CFB modes: iv length is 16 bytes. |

**Example:**

<!-- compile -->

```cangjie
// index.cj

import kit.CryptoArchitectureKit.*

let iv = IvParamsSpec("IvParamsSpec", DataBlob(Array<UInt8>(8, repeat: 1)))
```

## enum CipherSpecItem

```cangjie
public enum CipherSpecItem <: Equatable<CipherSpecItem> & ToString {
    | OAEP_MD_NAME_STR
    | OAEP_MGF_NAME_STR
    | OAEP_MGF1_MD_STR
    | OAEP_MGF1_PSRC_UINT8ARR
    | ...
}
```

**Function:** An enumeration representing encryption/decryption parameters that can be set via the setCipherSpec interface or obtained via the getCipherSpec interface.

Currently only supports RSA and SM2 algorithms.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parent Type:**

- Equatable\<CipherSpecItem>
- ToString

### OAEP_MD_NAME_STR

```cangjie
OAEP_MD_NAME_STR
```

**Function:** Represents the algorithm name of the message digest function when using PKCS1_OAEP mode in RSA algorithm.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### OAEP_MGF1_MD_STR

```cangjie
OAEP_MGF1_MD_STR
```

**Function:** Represents the message digest algorithm for MGF1 mask generation function when using PKCS1_OAEP mode in RSA algorithm.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### OAEP_MGF1_PSRC_UINT8ARR

```cangjie
OAEP_MGF1_PSRC_UINT8ARR
```

**Function:** Represents the byte stream of pSource when using PKCS1_OAEP mode in RSA algorithm.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### OAEP_MGF_NAME_STR

```cangjie
OAEP_MGF_NAME_STR
```

**Function:** Represents the mask generation algorithm (currently only MGF1 is supported) when using PKCS1_OAEP mode in RSA algorithm.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### func !=(CipherSpecItem)

```cangjie
public operator func !=(other: CipherSpecItem): Bool
```

**Function:** Determines whether two enumeration values are not equal.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Name | Type | Mandatory | Default | Description |
|:---|:---|:---|:---|:---|
| other | [CipherSpecItem](#enum-cipherspecitem) | Yes | - | Another enumeration value. |

**Return Value:**

| Type | Description |
|:----|:----|
| Bool | Returns true if the two enumeration values are not equal, otherwise returns false. |

### func ==(CipherSpecItem)

```cangjie
public operator func ==(other: CipherSpecItem): Bool
```

**Function:** Determines whether two enumeration values are equal.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Name | Type | Mandatory | Default | Description |
|:---|:---|:---|:---|:---|
| other | [CipherSpecItem](#enum-cipherspecitem) | Yes | - | Another enumeration value. |

**Return Value:**

| Type | Description |
|:----|:----|
| Bool | Returns true if the two enumeration values are equal, otherwise returns false. |

### func toString()

```cangjie
public func toString(): String
```

**Function:** Gets the value of the enumeration.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| String | Description of the enumeration. |

## enum CryptoMode

```cangjie
public enum CryptoMode <: Equatable<CryptoMode> & ToString {
    | ENCRYPT_MODE
    | DECRYPT_MODE
    | ...
}
```

**Function:** Represents encryption and decryption operations.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parent Types:**

- Equatable\<CryptoMode>
- ToString

### DECRYPT_MODE

```cangjie
DECRYPT_MODE
```

**Function:** Represents decryption operation.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### ENCRYPT_MODE

```cangjie
ENCRYPT_MODE
```

**Function:** Represents encryption operation.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

### func !=(CryptoMode)

```cangjie
public operator func !=(other: CryptoMode): Bool 
```

**Function:** Determines whether two enumeration values are not equal.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Name | Type | Mandatory | Default | Description |
|:---|:---|:---|:---|:---|
| other | [CryptoMode](#enum-cryptomode) | Yes | - | Another enumeration value. |

**Return Value:**

| Type | Description |
|:----|:----|
| Bool | Returns true if the two enumeration values are not equal, otherwise returns false. |

### func ==(CryptoMode)

```cangjie
public operator func ==(other: CryptoMode): Bool
```

**Function:** Determines whether two enumeration values are equal.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Parameters:**

| Name | Type | Mandatory | Default | Description |
|:---|:---|:---|:---|:---|
| other | [CryptoMode](#enum-cryptomode) | Yes | - | Another enumeration value. |

**Return Value:**

| Type | Description |
|:----|:----|
| Bool | Returns true if the two enumeration values are equal, otherwise returns false. |

### func toString()

```cangjie
public func toString(): String
```

**Function:** Gets the value of the enumeration.

**System Capability:** SystemCapability.Security.CryptoFramework.Cipher

**Since:** 21

**Return Value:**

| Type | Description |
|:----|:----|
| String | Description of the enumeration. |

## enum Result

```cangjie
public enum Result <: ToString {
    | INVALID_PARAMS
    | NOT_SUPPORT
    | ERR_OUT_OF_MEMORY
    | ERR_RUNTIME_ERROR
    | ERR_CRYPTO_OPERATION
    | ...
}
```

**Function:** Represents execution results.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

**Parent Types:**

- ToString

### ERR_CRYPTO_OPERATION

```cangjie
ERR_CRYPTO_OPERATION
```

**Function:** Error occurred when calling third-party algorithm library API.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### ERR_OUT_OF_MEMORY

```cangjie
ERR_OUT_OF_MEMORY
```

**Function:** Memory error.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### ERR_RUNTIME_ERROR

```cangjie
ERR_RUNTIME_ERROR
```

**Function:** External runtime error.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### INVALID_PARAMS

```cangjie
INVALID_PARAMS
```

**Function:** Invalid parameters.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### NOT_SUPPORT
```cangjie
NOT_SUPPORT
```

**Function:** Operation not supported.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

### func getValue()

```cangjie
public func getValue(): Int32
```

**Function:** Gets the value of the enumeration.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

**Return Value:**

|Type|Description|
|:----|:----|
|Int32|The value of the enumeration.|

### func toString()

```cangjie
public func toString(): String
```

**Function:** Gets the description of the enumeration.

**System Capability:** SystemCapability.Security.CryptoFramework

**Since:** 21

**Return Value:**

|Type|Description|
|:----|:----|
|String|The description of the enumeration.|