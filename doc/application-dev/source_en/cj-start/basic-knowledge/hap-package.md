# HAP  

HAP (Harmony Ability Package) is the fundamental unit for application installation and operation. An HAP package is a modular bundle generated by packaging code, resources, third-party libraries, configuration files, etc. It is primarily categorized into two types: entry and feature.  

- **entry**: The main module of an application, serving as the entry point and providing the basic functionalities of the application.  
- **feature**: The dynamic feature module of an application, acting as an extension of its capabilities. It can be selectively installed based on user requirements and device types.  

An application package may consist of only a basic entry package or include a basic entry package along with multiple functional feature packages.  

## Usage Scenarios  

- **Single HAP Scenario**: If the package contains only UIAbility components and does not require ExtensionAbility components, it is recommended to adopt a single HAP (i.e., one entry package) for application development. Although a single HAP may contain one or more UIAbility components, to avoid unnecessary resource loading, the "one UIAbility + multiple pages" approach is recommended.  

- **Multi-HAP Scenario**: If the application's functionality is complex and requires the use of ExtensionAbility components, a multi-HAP approach (i.e., one entry package + multiple feature packages) can be adopted for application development. Each HAP should contain either one UIAbility component or one ExtensionAbility component. In this scenario, multiple HAPs referencing the same library files may lead to duplicate packaging issues.  

## Constraints  

- Exporting interfaces or Cangjie components for use by other modules is not supported.  

- In a multi-HAP scenario, an App Pack can contain at most one Entry-type HAP per device type, or none at all. Feature-type HAPs can include one or multiple instances, or none.  

- In a multi-HAP scenario, all HAPs within the same application must have identical configurations for `bundleName`, `versionCode`, `versionName`, `minCompatibleVersionCode`, `debug`, `minAPIVersion`, `targetAPIVersion`, and `apiReleaseType` in their configuration files. Additionally, the `moduleName` tag must be unique for all HAPs corresponding to the same device type. When packaging HAPs into an App Pack, these parameters are validated.  

- In a multi-HAP scenario, all HAPs of the same application must use the same signing certificate. When publishing to the app market in the form of an App Pack, the market will split all HAPs from the App Pack and re-sign them to ensure certificate consistency. During the debugging phase, developers must ensure that all HAPs installed via the command line or DevEco Studio share the same signing certificate; otherwise, installation may fail. For signing operations, refer to [Application/Meta Service Signing](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-signing).  

## Creation  

Below is a brief guide on how to create a new HAP module using DevEco Studio.  

1. Create a project to build the first Cangjie application.  
2. Right-click on the project directory and select **New > Module**.  
3. In the dialog box, select the **[Cangjie] Empty Ability** template and click **Next**.  
4. On the Module configuration page, specify the **Module name**, select **Module Type** and **Device Type**, then click **Next**.  
5. On the Ability configuration page, specify the **Ability name** and click **Finish** to complete the creation.  

## Development  

- Cangjie HAPs support referencing HARs. For details, see [HAR Usage](./har-package.md#HAR).  

## Debugging  

Compile and package the project using DevEco Studio to generate one or multiple HAPs, which can then be used for debugging. To customize the compilation of the same HAP into different versions based on deployment environments, target audiences, or runtime conditions, refer to [Customized Compilation Guide](https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides#section1011341611469).  

Developers can debug using DevEco Studio or the hdc tool:  

- **Method 1**: Debug using DevEco Studio. For details, refer to the application package debugging method <!-- add link -->.  

- **Method 2**: Debug using the [hdc tool](../../tools/cj-hdc.md).  

    Before debugging, the HAP must be installed or updated. There are two approaches:  

    - **Directly install/update HAP using hdc**:  
        The HAP path refers to the file path on the development platform. For example, on a Windows platform, the commands are as follows:  

        ```shell  
        # Install/update; multiple HAPs can be specified  
        hdc install entry.hap feature.hap  
        # Execution result  
        install bundle successfully.  
        # Uninstall  
        hdc uninstall com.example.myapplication  
        # Execution result  
        uninstall bundle successfully.  
        ```  

    - **Use the bm tool after executing hdc shell**:  
        The HAP file path refers to the path on the physical device. The commands are as follows:  

        ```shell  
        # Execute hdc shell first to use the bm tool  
        hdc shell  
        # Install/update; multiple HAPs can be specified  
        bm install -p /data/app/entry.hap /data/app/feature.hap  
        # Execution result  
        install bundle successfully.  
        # Uninstall  
        bm uninstall -n com.example.myapplication  
        # Execution result  
        uninstall bundle successfully.  
        ```  

    After installing or updating the HAP, proceed with debugging using the relevant [debugging commands](../../tools/cj-aa-tool.md).